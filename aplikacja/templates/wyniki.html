<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<script type="text/javascript" src="chart.js"></script>
<script type="text/javascript" src="chartjs-datalabels.js"></script>
</head>
<body>
<p id="demo"></p>
<div style="width: 500px;">  
<canvas id="myChart"></canvas>
<canvas id="myChart2"></canvas>
<canvas id="myChart3"></canvas>
<canvas id="myPieChart"></canvas>
<canvas id="myPieChart2"></canvas>
<canvas id="myPieChart3"></canvas>
</div>
<script>
var tablica = [

	[1, "<18", "F", "gimnazjalne", "Tak", "TV", 100, 0, "Nie", "ta ankieta", 100, 1, "Nie", "ta ankieta", 50, 1, "Tak", "internet", 100, 1, "Tak", "internet", 25, 0, "Nie", "ta ankieta", 0, 0, "Tak", "TV", 25, 1, "Tak", "internet", 50, 0, "Tak", "TV", 50, 0, "Nie", "ta ankieta", 75, 0],
	[2, "18-25", "M", "średnie", "Nie", "ta ankieta", 75, 0, "Tak", "TV", 25, 1, "Tak", "internet", 75, 1, "Nie", "ta ankieta", 0, 1, "Tak", "internet", 100, 0, "Tak", "TV", 25, 0, "Tak", "internet", 100, 1, "Tak", "internet", 100, 0, "Tak", "TV", 50, 0, "Tak", "internet", 0, 0],
	[3, "60+", "M", "podstawowe", "Nie", "ta ankieta", 25, 0, "Nie", "ta ankieta", 25, 1, "Tak", "gazeta", 100, 0, "Tak", "gazeta", 25, 1, "Tak", "gazeta", 0, 0, "Nie", "ta ankieta", 50, 0, "Tak", "TV", 100, 1, "Tak", "TV", 100, 0, "Nie", "ta ankieta", 75, 0, "Tak", "TV", 50, 0],
	[4, "<18", "F", "brak", "Nie", "ta ankieta", 100, 0, "Tak", "internet", 0, 1, "Tak", "internet", 100, 0, "Tak", "internet", 25, 1, "Tak", "internet", 75, 0, "Nie", "ta ankieta", 0, 0, "Nie", "ta ankieta", 100, 1, "Tak", "internet", 100, 0, "Tak", "internet", 75, 0, "Tak", "internet", 25, 0],
	[5,"18-25", "F", "inne", "Tak", "internet", 25, 0,
	"Tak", "internet", 25, 1,
	"Tak", "internet", 50, 1,
	"Nie", "ta ankieta", 100, 1,
	"Nie", "ta ankieta", 75, 0,
	"Nie", "ta ankieta", 75, 0,
	"Tak", "internet", 0, 1,
	"Tak", "internet", 0, 0,
	"Tak", "internet", 75, 0,
	"Nie", "ta ankieta", 100, 0,],

	[6,"25-40", "M", "wyższe", "Tak", "internet", 25, 0,
	"Tak", "radio", 75, 1,
	"Tak", "tv", 0, 1,
	"Nie", "ta ankieta", 50, 1,
	"Tak", "radio", 50, 0,
	"Nie", "ta ankieta", 0, 0,
	"Tak", "radio", 100, 1,
	"Tak", "tv", 100, 0,
	"Tak", "internet", 75, 0,
	"Nie", "ta ankieta", 25, 0,]
	];
	var TLen = tablica.length;
	var wyniki = [];
	for(var k=0; k<TLen; k++){
		wyniki[k] = tablica[k].slice(0, 4);
		wyniki[k].push(0);
		};

	for(var i=0; i<TLen; i++){
		for(var j=6; j<43; j=j+4){
			if((tablica[i][j] == 100 || tablica[i][j] == 75) && tablica[i][j+1] == 1){
				wyniki[i][4] += 10;
				}else if((tablica[i][j] == 0 || tablica[i][j] == 25) && tablica[i][j+1] == 0){
				wyniki[i][4] += 10;
				}
			
		}
	}	
	var WLen = wyniki.length;
	var wiek = Array(5).fill(0);
	var zmienna1 = 0;
	var zmienna2 = 0;
	var zmienna3 = 0;
	var zmienna4 = 0;
	var zmienna5 = 0;
	
	for(var l = 0; l<WLen; l++){
		if(wyniki[l][1] == "<18"){
			wiek[0] += wyniki[l][4];
			zmienna1 += 1;
		}else if(wyniki[l][1] == "18-25"){
			wiek[1] += wyniki[l][4];
			zmienna2 += 1;
		}else if(wyniki[l][1] == "25-40"){
			wiek[2] += wyniki[l][4];
			zmienna3 += 1;
		}else if(wyniki[l][1] == "41-60"){
			wiek[3] += wyniki[l][4];
			zmienna4 += 1;
		}else if(wyniki[l][1] == "60+"){
			wiek[4] += wyniki[l][4];
			zmienna5 += 1;
		}
	}
	
	if(zmienna1>0){
		wiek[0] = Math.round(wiek[0]/zmienna1);
	}
	if(zmienna2>0){
		wiek[1] = Math.round(wiek[1]/zmienna2);
	}
	if(zmienna3>0){
		wiek[2] = Math.round(wiek[2]/zmienna3);
	}
	if(zmienna4>0){
		wiek[3] = Math.round(wiek[3]/zmienna4);
	}
	if(zmienna5>0){
		wiek[4] = Math.round(wiek[4]/zmienna5);
	}
	
	var plec = Array(2).fill(0);
	var zmienna6 = 0;
	var zmienna7 = 0;

	
	for(var m = 0; m<WLen; m++){
		if(wyniki[m][2] == "M"){
			plec[0] += wyniki[m][4];
			zmienna6 += 1;
		}else if(wyniki[m][2] == "F"){
			plec[1] += wyniki[m][4];
			zmienna7 += 1;
		}
	}
	
	if(zmienna6>0){
		plec[0] = Math.round(plec[0]/zmienna6);
	}
	if(zmienna7>0){
		plec[1] = Math.round(plec[1]/zmienna7);
	}
	
	var wyksztalcenie = Array(7).fill(0);
	var zmienna8 = 0;
	var zmienna9 = 0;
	var zmienna10 = 0;
	var zmienna11 = 0;
	var zmienna12 = 0;
	var zmienna13 = 0;
	var zmienna14 = 0;
	
	for(var n = 0; n<WLen; n++){
		if(wyniki[n][3] == "brak"){
			wyksztalcenie[0] += wyniki[n][4];
			zmienna8 += 1;
		}else if(wyniki[n][3] == "podstawowe"){
			wyksztalcenie[1] += wyniki[n][4];
			zmienna9 += 1;
		}else if(wyniki[n][3] == "gimnazjalne"){
			wyksztalcenie[2] += wyniki[n][4];
			zmienna10 += 1;
		}else if(wyniki[n][3] == "średnie"){
			wyksztalcenie[3] += wyniki[n][4];
			zmienna11 += 1;
		}else if(wyniki[n][3] == "zawodowe"){
			wyksztalcenie[4] += wyniki[n][4];
			zmienna12 += 1;
		}else if(wyniki[n][3] == "wyższe"){
			wyksztalcenie[5] += wyniki[n][4];
			zmienna13 += 1;
		}else if(wyniki[n][3] == "inne"){
			wyksztalcenie[6] += wyniki[n][4];
			zmienna14 += 1;
		}
	}
	
	if(zmienna8>0){
		wyksztalcenie[0] = Math.round(wyksztalcenie[0]/zmienna8);
	}
	if(zmienna9>0){
		wyksztalcenie[1] = Math.round(wyksztalcenie[1]/zmienna9);
	}
	if(zmienna10>0){
		wyksztalcenie[2] = Math.round(wyksztalcenie[2]/zmienna10);
	}
	if(zmienna11>0){
		wyksztalcenie[3] = Math.round(wyksztalcenie[3]/zmienna11);
	}
	if(zmienna12>0){
		wyksztalcenie[4] = Math.round(wyksztalcenie[4]/zmienna12);
	}
	if(zmienna13>0){
		wyksztalcenie[5] = Math.round(wyksztalcenie[5]/zmienna13);
	}
	if(zmienna14>0){
		wyksztalcenie[6] = Math.round(wyksztalcenie[6]/zmienna14);
	}

	
	//document.getElementById("demo").innerHTML = wyniki;
	
var wiekwykres = document.getElementById('myChart').getContext('2d');
var myChart = new Chart(wiekwykres, {
    type: 'bar',
    data: {
        labels: ['<18', '18-25', '25-40', '41-60', '60+'],
        datasets: [{
            label: '% poprawnych zgadnięć względem wieku',
            data: wiek,
            backgroundColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'
            ],
            borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }]
        }
    }
});

var plecwykres = document.getElementById('myChart2').getContext('2d');
var myChart2 = new Chart(plecwykres, {
    type: 'bar',
    data: {
        labels: ['Mężczyźni', 'Kobiety'],
        datasets: [{
            label: '% poprawnych zgadnięć względem płci',
            data: plec,
            backgroundColor: [
				'rgba(54, 162, 235, 1)',
                'rgba(255, 99, 132, 1)',


            ],
            borderColor: [
				'rgba(54, 162, 235, 1)',
                'rgba(255, 99, 132, 1)',
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }]
        }
    }
});

var wyksztalceniewykres = document.getElementById('myChart3').getContext('2d');
var myChart3 = new Chart(wyksztalceniewykres, {
    type: 'bar',
    data: {
        labels: ['brak', 'podstawowe', 'gimnazjalne', 'średnie', 'zawodowe', 'wyższe', 'inne'],
        datasets: [{
            label: '% poprawnych zgadnięć względem wykształcenia',
            data: wyksztalcenie,
            backgroundColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)',
				'rgba(43, 179, 13, 1)'
            ],
            borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)',
				'rgba(43, 179, 13, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }]
        }
    }
});

var ctxP = document.getElementById("myPieChart").getContext('2d');
var myPieChart = new Chart(ctxP, {
  plugins: [ChartDataLabels],
  type: 'pie',
  data: {
    labels: ["<18", "18-25", "25-40", "41-60", "60+"],
    datasets: [{
      data: [zmienna1, zmienna2, zmienna3, zmienna4, zmienna5],
      backgroundColor: ["#F7464A", "#46BFBD", "#FDB45C", "#949FB1", "#4D5360"],
      hoverBackgroundColor: ["#FF5A5E", "#5AD3D1", "#FFC870", "#A8B3C5", "#616774"]
    }]
  },
  options: {
    responsive: true,
    legend: {
      position: 'right',
      labels: {
        padding: 20,
        boxWidth: 10
      }
    },
    plugins: {
      datalabels: {
        formatter: (value, ctx) => {
          let sum = 0;
          let dataArr = ctx.chart.data.datasets[0].data;
          dataArr.map(data => {
            sum += data;
          });
          let percentage = (value * 100 / sum).toFixed(2) + "%";
          return percentage;
        },
        color: 'white',
        labels: {
          title: {
            font: {
              size: '16'
            }
          }
        }
      }
    }
  }
});

var ctxP2 = document.getElementById("myPieChart2").getContext('2d');
var myPieChart2 = new Chart(ctxP2, {
  plugins: [ChartDataLabels],
  type: 'pie',
  data: {
    labels: ["Mężczyźni", "Kobiety"],
    datasets: [{
      data: [zmienna6, zmienna7],
      backgroundColor: ["#F7464A", "#46BFBD"],
      hoverBackgroundColor: ["#FF5A5E", "#5AD3D1"]
    }]
  },
  options: {
    responsive: true,
    legend: {
      position: 'right',
      labels: {
        padding: 20,
        boxWidth: 10
      }
    },
    plugins: {
      datalabels: {
        formatter: (value, ctx) => {
          let sum = 0;
          let dataArr = ctx.chart.data.datasets[0].data;
          dataArr.map(data => {
            sum += data;
          });
          let percentage = (value * 100 / sum).toFixed(2) + "%";
          return percentage;
        },
        color: 'white',
        labels: {
          title: {
            font: {
              size: '16'
            }
          }
        }
      }
    }
  }
});

var ctxP3 = document.getElementById("myPieChart3").getContext('2d');
var myPieChart3 = new Chart(ctxP3, {
  plugins: [ChartDataLabels],
  type: 'pie',
  data: {
    labels: ['brak', 'podstawowe', 'gimnazjalne', 'średnie', 'zawodowe', 'wyższe', 'inne'],
    datasets: [{
      data: [zmienna8, zmienna9, zmienna10, zmienna11, zmienna12, zmienna13, zmienna14],
      backgroundColor: ["#F7464A", "#46BFBD", "#FDB45C", "#949FB1", "#4D5360", "#9447FF", "#4C76FF"],
      hoverBackgroundColor: ["#FF5A5E", "#5AD3D1", "#FFC870", "#A8B3C5", "#616774", "#A361FF", "#7091FF"]
    }]
  },
  options: {
    responsive: true,
    legend: {
      position: 'right',
      labels: {
        padding: 20,
        boxWidth: 10
      }
    },
    plugins: {
      datalabels: {
        formatter: (value, ctx) => {
          let sum = 0;
          let dataArr = ctx.chart.data.datasets[0].data;
          dataArr.map(data => {
            sum += data;
          });
          let percentage = (value * 100 / sum).toFixed(2) + "%";
          return percentage;
        },
        color: 'white',
        labels: {
          title: {
            font: {
              size: '16'
            }
          }
        }
      }
    }
  }
});
</script>
</body>
</html>